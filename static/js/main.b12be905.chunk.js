(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{10:function(e,t,a){e.exports=a.p+"static/media/del-icon.4220563a.svg"},15:function(e,t,a){e.exports=a(21)},20:function(e,t,a){},21:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),c=a(8),r=a.n(c),i=(a(20),a(13)),l=a(1),p=a(9),u=a.n(p);var s=function(){return o.a.createElement("header",{className:"page__section header"},o.a.createElement("img",{src:u.a,className:"header__logo",alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f Mesto Russia"}))},m=a(5),d=a(6),_=new(function(){function e(t){var a=t.baseUrl,n=t.headersAuthorization;Object(m.a)(this,e),this._baseUrl=a,this._headersAuthorization=n,this._call=this._call.bind(this)}return Object(d.a)(e,[{key:"_call",value:function(e,t,a){var n={method:e,headers:{authorization:this._headersAuthorization,"Content-Type":"application/json"}};return a&&(n.body=JSON.stringify(a)),fetch("".concat(this._baseUrl,"/").concat(t),n).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"getUserInfo",value:function(){return this._call("GET","users/me")}},{key:"updateUserInfo",value:function(e){return this._call("PATCH","users/me",e)}},{key:"getInitialCards",value:function(){return this._call("GET","cards")}},{key:"addCard",value:function(e){return this._call("POST","cards",e)}},{key:"deleteCard",value:function(e){return this._call("DELETE","cards/".concat(e))}},{key:"likeCard",value:function(e){return this._call("PUT","cards/likes/".concat(e))}},{key:"dislikeCard",value:function(e){return this._call("DELETE","cards/likes/".concat(e))}},{key:"updateAvatar",value:function(e){return this._call("PATCH","users/me/avatar",e)}},{key:"changeLikeStatus",value:function(e,t){return t?this.likeCard(e):this.dislikeCard(e)}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-14",headersAuthorization:"e334a560-7923-4c10-ad97-03986e985b68"}),f=a(10),h=a.n(f),v=o.a.createContext();var E=function(e){var t=e.card,a=e.onCardClick,n=e.onCardLike,c=e.onCardDelete,r=o.a.useContext(v),i=t.name,l=t.link,p=t.likes,u=t.owner._id===r._id,s="place__image-del ".concat(u?"":"place__image-del_hidden"),m=t.likes.some((function(e){return e._id===r._id})),d="place__title-like ".concat(m?"place__title-like_selected":"");return o.a.createElement("div",{className:"place"},o.a.createElement("img",{src:l,className:"place__image",alt:"",onClick:function(){a(t)}}),o.a.createElement("button",{type:"button",className:s,style:{backgroundImage:"url(".concat(h.a,")")},onClick:function(){c(t)}}),o.a.createElement("div",{className:"place__title"},o.a.createElement("h3",{className:"place__title-text"},i),o.a.createElement("div",{className:"place__title-like-block"},o.a.createElement("button",{type:"button",className:d,onClick:function(){n(t)}}),o.a.createElement("h5",{className:"place__title-like-count"},p.length))))};var b=function(e){var t=e.onEditProfile,a=e.onAddPlace,n=e.onEditAvatar,c=e.onCardClick,r=e.onCardLike,i=e.onCardDelete,l=e.cards,p=o.a.useContext(v);return o.a.createElement(o.a.Fragment,null,o.a.createElement("section",{className:"profile page__section"},o.a.createElement("button",{className:"profile__photo",onClick:n,style:{backgroundImage:"url(".concat(p.avatar,")")}}),o.a.createElement("div",{className:"profile__info"},o.a.createElement("div",{className:"profile__title"},o.a.createElement("h1",{className:"profile__full-name"},p.name),o.a.createElement("button",{type:"button",className:"profile__edit-button",onClick:t})),o.a.createElement("p",{className:"profile__profession"},p.about)),o.a.createElement("button",{type:"button",className:"profile__add-button",onClick:a})),o.a.createElement("section",{className:"places page__section"},l.map((function(e){return o.a.createElement(E,{card:e,onCardClick:c,onCardLike:r,onCardDelete:i,key:e._id})}))))};var g=function(){return o.a.createElement("footer",{className:"footer page__section"},o.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))};var k=function(e){var t=e.card,a=e.onClose,c=Object(n.useRef)();return o.a.createElement("div",{className:"popup-preview ".concat(0===Object.keys(t).length?"popup_closed":"popup_opened")},o.a.createElement("div",{className:"popup-container popup-preview__container",ref:c},o.a.createElement("img",{src:t.link,className:"popup-preview__image",alt:"",onLoad:function(e){c.current.style.width="".concat(e.target.offsetWidth,"px"),c.current.style.height="".concat(e.target.offsetHeight,"px")}}),o.a.createElement("button",{type:"button",className:"popup__button-close",onClick:a}),o.a.createElement("p",{className:"popup-preview__description"},t.name)))},C=a(11),N=a(3),y=a(14),O=a(12);var j=function(e){var t=e.title,a=e.name,n=e.isOpen,c=e.onClose,r=e.onSubmit,i=e.children;return o.a.createElement("div",{className:"popup ".concat(n?"popup_opened":"popup_closed","  popup_").concat(a)},o.a.createElement("div",{className:"popup-container popup__container"},o.a.createElement("form",{className:"popup__form popup__form-edit_".concat(a),name:a,action:"#",method:"GET",onSubmit:r},o.a.createElement("h4",{className:"popup__header"},t),i,o.a.createElement("button",{className:"popup__button-save",type:"submit"},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")),o.a.createElement("button",{type:"button",className:"popup__button-close",onClick:c})))},x=function(e){Object(y.a)(a,e);var t=Object(O.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).props=e,n.handleInputChange=n.handleInputChange.bind(Object(N.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(N.a)(n)),n.prevContext=null,n.state={name:"",about:""},n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.prevContext=this.context}},{key:"componentDidUpdate",value:function(){this.prevContext._id!==this.context._id&&(this.setState({name:this.context.name,description:this.context.about}),this.prevContext=this.context)}},{key:"handleInputChange",value:function(e){var t=e.target.name;this.setState(Object(C.a)({},t,e.target.value))}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.onUpdateUser({name:this.state.name,about:this.state.description}),this.props.onClose()}},{key:"render",value:function(){return o.a.createElement(j,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"profile",isOpen:this.props.isOpen,onClose:this.props.onClose,onSubmit:this.handleSubmit},o.a.createElement("input",{id:"popup-input-full-name",className:"popup__input popup__input_full-name",name:"name",type:"text",placeholder:"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",minLength:"2",maxLength:"40",required:!0,value:this.state.name||"",onChange:this.handleInputChange}),o.a.createElement("span",{id:"popup-input-full-name-error",className:"popup__input-error"}),o.a.createElement("input",{id:"popup-input-profession",className:"popup__input popup__input_profession",name:"description",type:"text",placeholder:"\u041f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u044f",minLength:"2",maxLength:"200",required:!0,value:this.state.description||"",onChange:this.handleInputChange}),o.a.createElement("span",{id:"popup-input-profession-error",className:"popup__input-error"}))}}]),a}(o.a.Component);x.contextType=v;var S=x;var L=function(e){var t=e.isOpen,a=e.onClose,c=e.onUpdateAvatar,r=Object(n.useRef)();return o.a.createElement(j,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"update-avatar",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),c({avatarLink:r.current.value}),a()}},o.a.createElement("input",{id:"popup-input-avatar-image-link",className:"popup__input popup__input_update-avatar-link",name:"popup__input_update-avatar-link",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",required:!0,ref:r}),o.a.createElement("span",{id:"popup-input-avatar-image-link-error",className:"popup__input-error"}))};var A=function(e){var t=e.isOpen,a=e.onClose,c=e.onAddPlace,r=Object(n.useRef)(),i=Object(n.useRef)();return o.a.createElement(j,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"add-card",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),c({name:r.current.value,link:i.current.value}),a(),r.current.value="",i.current.value=""}},o.a.createElement("input",{id:"popup-input-place-name",className:"popup__input popup__input_place-name",name:"popup__input_place-name",type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",minLength:"1",maxLength:"30",required:!0,ref:r}),o.a.createElement("span",{id:"popup-input-place-name-error",className:"popup__input-error"}),o.a.createElement("input",{id:"popup-input-place-image-link",className:"popup__input popup__input_place-image-link",name:"popup__input_place-image-link",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,ref:i}),o.a.createElement("span",{id:"popup-input-place-image-link-error",className:"popup__input-error"}))};var U=function(){var e=o.a.useState(!1),t=Object(l.a)(e,2),a=t[0],n=t[1],c=o.a.useState(!1),r=Object(l.a)(c,2),p=r[0],u=r[1],m=o.a.useState(!1),d=Object(l.a)(m,2),f=d[0],h=d[1],E=o.a.useState({}),C=Object(l.a)(E,2),N=C[0],y=C[1],O=o.a.useState({}),j=Object(l.a)(O,2),x=j[0],U=j[1];o.a.useEffect((function(){_.getUserInfo().then((function(e){U(e),console.log("get user info")}))}),[]);var I=o.a.useState([]),P=Object(l.a)(I,2),T=P[0],D=P[1];function w(){h(!1),n(!1),u(!1),y({})}return o.a.useEffect((function(){Promise.all([_.getInitialCards()]).then((function(e){var t=Object(l.a)(e,1)[0];D(t)})).catch((function(e){console.log(e)}))}),[]),o.a.createElement("div",{className:"page"},o.a.createElement(v.Provider,{value:x},o.a.createElement(s,null),o.a.createElement(b,{onEditProfile:function(){n(!0)},onAddPlace:function(){u(!0)},onEditAvatar:function(){h(!0)},onCardClick:function(e){y(e)},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===x._id}));_.changeLikeStatus(e._id,!t).then((function(t){var a=T.map((function(a){return a._id===e._id?t:a}));D(a)})).catch((function(e){console.log(e)}))},onCardDelete:function(e){_.deleteCard(e._id).then((function(t){var a=T.filter((function(t){return t._id!==e._id}));D(a)})).catch((function(e){console.log(e)}))},cards:T}),o.a.createElement(g,null),o.a.createElement(S,{isOpen:a,onClose:w,onUpdateUser:function(e){console.log(e),_.updateUserInfo(e).then((function(e){U(e)})).catch((function(e){console.log(e)}))}}),o.a.createElement(A,{isOpen:p,onClose:w,onAddPlace:function(e){_.addCard(e).then((function(e){console.log(e),D([].concat(Object(i.a)(T),[e]))})).catch((function(e){console.log(e)}))}}),o.a.createElement(L,{isOpen:f,onClose:w,onUpdateAvatar:function(e){var t=e.avatarLink;_.updateAvatar({avatar:t}).then((function(e){U(e)})).catch((function(e){console.log(e)}))}}),o.a.createElement(k,{card:N,onClose:w}),o.a.createElement("div",{className:"popup popup_closed popup_confirm"},o.a.createElement("div",{className:"popup-container popup__container"},o.a.createElement("form",{className:"popup__form popup__form-confirm",name:"confirm",action:"#",method:"POST"},o.a.createElement("h4",{className:"popup__header popup__header_confirm"},"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?"),o.a.createElement("button",{className:"popup__button-yes",type:"submit"},"\u0414\u0430")),o.a.createElement("button",{type:"button",className:"popup__button-close"})))))};r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(U,null)),document.getElementById("root"))},9:function(e,t,a){e.exports=a.p+"static/media/logo.c6f11019.svg"}},[[15,1,2]]]);
//# sourceMappingURL=main.b12be905.chunk.js.map